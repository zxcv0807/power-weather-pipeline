# 데이터 레이크 구축

## MiniO

MiniO는 S3 API와 완벽하게 호환되는 오픈소스 객체 스토리지 서버이다.
AWS S3를 로컬에서 복제해 실행할 수 있게 해주는 경량화된 S3 시뮬레이터라고 보면 된다.

### 사용하는 이유

1. 코드 일관성
만약 데이터를 로컬 파일 시스템(예: C:\data)에 저장하면, 스파크 코드는 spark.read.parquet("file:///C:/data/...")가 된다.
그렇다면 이후에 로컬에서 AWS로 마이그레이션을 하게되면 코드를 spark.read.parquet("s3a://my-bucket/data/...")로 전부 수정해야 한다.
하지만 MiniO를 사용하게 되면 최종 코드인 s3a://... 를 똑같이 사용할 수 있게 된다.

2. 클라우드 환경의 완벽한 모방
- MiniO는 Airflow, Spark(Batch Job)와 연동하여 로컬 데이터 레이크 역할을 할 수 있다.
- Spark가 분석한 결과를 MiniO에 parquet 파일로 저장한다.
- 이는 AWS S3에 데이터를 저장하는 방식과 완전히 동일하다. 로컬에서 미리 리허설을 하는 것과 같다.

3. 비용 절감 및 속도 향상
- 개발 및 테스트 환경에서 매번 AWS S3를 사용하면 인터넷 연결이 필수이고, 불필요한 비용과 네트워크 지연이 발생할 수 있다.
- MiniO는 docker로 빠른 속도로 띄울 수 있고, 비용이 들지 않으며, 로컬이기 때문에 속도도 매우 빠르다.

### 참고
Hadoop/Spark가 S3에 접속하는 프로토콜은 발전해왔다.
`s3://`, `s3n://`이 과거에는 사용되었지만, 현재는 **`s3a://` (AWS SDK)**가 현재 표준으로써 사용된다.
파일 크기 제한이 없고, 병렬 전송을 지원하여 성능이 가장 뛰어나다고 평가받는다.

=> MiniO는 사실상 나중에 AWS S3로 이전할 거니까, 개발 단계에서부터 S3와 완전히 동일한 환경을 로컬에서 공짜로 구축해서 사용하기 위해 사용되는 S3 대체제이다.